<!DOCTYPE html>
<!-- Copyright 2013 the V8 project authors. Scroll to the end for full license -->
<html lang="en">

<head>
  <meta http-equiv="X-UA-Compatible" value="IE=edge" />
  <meta charset="utf-8" />
  <title>Forklift Benchmark</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Script-Type" content="text/javascript">
  <meta name="description" content="Forklift Benchmark">
  <meta name="author" content="Chrome Storage Team Google">
  <!-- Forklift benchmark code -->
  <script>
    function addScript(script) {
      document.write(`<script src=${script}?=${Date.now()}><\/script>`);
    }
    addScript('js/base.js');
    addScript('js/vanilla_lifecycle.js');
    addScript('js/vanilla_emptydb.js');
    addScript('js/vanilla_largedb.js');
    addScript('js/vanilla_largedb_compact.js');
    addScript('js/vanilla_populatethroughapp.js');
  </script>

  <script type="text/javascript">
    let completed = 0;
    const steps = Benchmark.CountSteps();
    let success = true;

    function ShowBox(benchmarkName, stepName) {
      completed++;
      document.getElementById('main-banner').innerHTML = `Running Forklift...<br>${benchmarkName}.${stepName}`;
      document.getElementById('progress-bar').style.width = `
        ${((completed) / steps) * 100}%`;
    }

    function AddResult(name, result) {}

    function AddError(name, error) {
      console.log(name + ': ' + error.message);
      if (error == 'TypedArrayUnsupported') {
        AddResult(name, '<b>Unsupported<\/b>');
      } else if (error == 'PerformanceNowUnsupported') {
        AddResult(name, '<b>Timer error<\/b>');
      } else {
        AddResult(name, '<b>Error</b>');
      }
      success = false;
    }

    function AddCycles(score) {
      const status = document.getElementById('main-banner');
      if (success) {
        status.innerHTML = `Forklift Cycles: ${score}`;
      } else {
        status.innerHTML = `Forklift Cycles (incomplete): ${score}`;
      }
      document.getElementById('progress-bar-container').style.visibility = 'hidden';
      document.getElementById('bottom-text').style.visibility = 'visible';
      document.getElementById('inside-anchor').removeChild(document.getElementById('bar-appendix'));
      document.getElementById('alertbox').style.visibility = 'hidden';
    }

    function Run() {
      document.getElementById('main-banner').innerHTML = 'Running Forklift...';
      // append the progress bar elements..
      document.getElementById('bar-appendix').innerHTML =
        `<br/><div class="progress" id="progress-bar-container" style="visibility:hidden"><div class="progress-bar" role="progressbar" style="width: 0%;" id="progress-bar"></div></div>`;
      const anchor = document.getElementById('run-forklift');
      const parent = document.getElementById('main-container');
      parent.appendChild(document.getElementById('inside-anchor'));
      parent.removeChild(anchor);

      document.getElementById('startup-text').innerHTML = '';

      document.getElementById('progress-bar-container').style.visibility = 'visible';

      Benchmark.RunBenchmarks({
        NotifyStart: ShowBox,
        NotifyError: AddError,
        NotifyResult: AddResult,
        NotifyScore: AddCycles,
      });
    }
  </script>
  <!-- end Forklift benchmark code -->

  <link href="css/main.css" rel="stylesheet">
  <link href="third_party/bootstrap/bootstrap.css" rel="stylesheet">
</head>

<body>

  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">Forklift</a>
  </nav>

  <div class="jumbotron">
    <div class="container">
      <div class="alert alert-warning" role="alert" style="display:none" id="alertbox">
        <strong>Warning</strong> This JavaScript engine does not support Typed Arrays. You might want to run the
        <a href="http://v8.googlecode.com/svn/data/benchmarks/v7/run.html">V8 benchmark v7</a> instead.
      </div>
      <div id="main-container">
        <a id="run-forklift" href="javascript:Run()">
          <div id="inside-anchor" style="margin-bottom: 10px">
            <h1 align="center" id="main-banner">Start Forklift</h1>
            <div id="bar-appendix"></div>
          </div>
        </a>
      </div>

      <div id="startup-text" style="color: black;" align="center"></div>

      <div class="header"></div>

      <div id="iframe-holder" style="visibility:hidden" align="center">
      </div>

      <div id="bottom-text" style="color:black; visibility:hidden" align="center">
      </div>

    </div> <!-- /container -->
  </div> <!-- /jumbotron -->

</body>

</html>

<!--
// Copyright 2013 the V8 project authors (http://code.google.com/p/v8/). 
// All rights reserved.
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are
// met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above
//       copyright notice, this list of conditions and the following
//       disclaimer in the documentation and/or other materials provided
//       with the distribution.
//     * Neither the name of Google Inc. nor the names of its
//       contributors may be used to endorse or promote products derived
//       from this software without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
// "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
